{"componentChunkName":"component---src-templates-post-js","path":"/defafadb-9d0e-5eed-aaff-b8c93f7d2c89","result":{"data":{"markdownRemark":{"id":"defafadb-9d0e-5eed-aaff-b8c93f7d2c89","html":"<p>qiitaã®è¨˜äº‹ãŒobjcã ã£ãŸã®ã§ã‚µã‚¯ãƒƒã¨ã‚³ãƒ”ãƒšã§å‹•ã‹ã—ãŸã„æ–¹ã«æœ€æ–°ç‰ˆã®ã‚³ãƒ¼ãƒ‰ã‚’å…±æœ‰</p>\n<h3>UILabelã«UIImageã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•</h3>\n<p>â‘ NSTextAttachmentã‚’ä½œæˆã™ã‚‹ã€‚\nâ‘¡NSTextAttachmentã‹ã‚‰NSAttributedStringã‚’ä½œæˆã™ã‚‹ã€‚\nâ‘¢UILabelã®attributedTextã«æŒ‡å®šã™ã‚‹ã€‚</p>\n<p>ç”»åƒã®ã‚µã‚¤ã‚ºã‚„è¡¨ç¤ºä½ç½®ã¯â‘ ã§èª¿æ•´ã—ã¾ã™</p>\n<p>ä»Šå›ã¯å®Ÿéš›ã«èµ·ã“ã‚Šãã†ãªã‚‚ã®ã¨ã—ã¦ã€ãƒ©ãƒ™ãƒ«ã®æœ«å°¾ã«ç”»åƒã‚’è¡¨ç¤ºã—ã¦ã¿ã¾ã™</p>\n<img width=\"286\" alt=\"ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ 2019-05-10 11.59.12.png\" src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/166241/9499259e-9a49-9ead-4243-78503e762f0f.png\">\n<div class=\"gatsby-highlight\" data-language=\".swift\"><pre class=\"language-.swift\"><code class=\"language-.swift\">    override func viewDidLoad() {\n        super.viewDidLoad()\n               \n        let text = &quot;labelã«çŠ¬ã‚’è¡¨ç¤ºã™ã‚‹&quot;\n        let image = UIImage(named: &quot;dog.jpg&quot;)!\n        let font: UIFont = .systemFont(ofSize: 30)\n        let size = CGSize(width: 30, height: 30)\n        \n        let attachment = NSTextAttachment()\n        attachment.image = image\n\n        let y = (font.capHeight-size.height).rounded() / 2\n        attachment.bounds.origin = CGPoint(x: 0, y: y)\n        attachment.bounds.size = size\n        \n        let imageAttribute = NSAttributedString(attachment: attachment)\n        let mutableString = NSMutableAttributedString(string: text)\n        mutableString.insert(imageAttribute, at: text.count)\n        \n        let label = UILabel()\n        view.addSubview(label)\n        label.textAlignment = .center\n        label.frame.size = .init(width: view.bounds.width-20, height: 50)\n        label.center = view.center\n        label.font = font\n        label.attributedText = mutableString\n    }  </code></pre></div>\n<p>attachmentã«sizeã‚’æŒ‡å®šã™ã‚‹ã¨è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ãŸã ãã‚Œã ã¨ã€ç”»åƒãŒè¡¨ç¤ºã•ã‚Œã‚‹é«˜ã•ãŒãšã‚Œã¦ã—ã¾ã†ã®ã§ã€\nä»Šå›ã¯ä¸­å¤®ã«æƒã†ã‚ˆã†ã«é«˜ã•ã‚’èª¿æ•´ã—ã¾ã—ãŸã€‚</p>\n<p>å½“ãŸã‚Šå‰ã§ã™ãŒinsertã™ã‚‹å ´æ‰€ã‚’ãšã‚‰ã›ã°ä¸­å¤®ã«è¡¨ç¤ºã§ãã¾ã™\n<img width=\"288\" alt=\"ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ 2019-05-10 12.00.20.png\" src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/166241/7db10ae9-d48d-8685-ff35-bc21c3237a9b.png\"></p>\n<p>ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã«çŠ¬ã®å†™çœŸã—ã‹ãªã‹ã£ãŸã§ã™ãŒã€ä¾‹ãˆã°ä»®æƒ³é€šè²¨ã®ä¿æœ‰é‡ï¼‹ğŸ’¶ï¼ˆé€šéã®ã‚¢ã‚¤ã‚³ãƒ³ï¼‰ã‚¹ã‚³ã‚¢ï¼‹ğŸ‘‘ï¼ˆç‹å† ã‚„ãƒ¡ãƒ€ãƒ«ï¼‰ãªã©ãŒè€ƒãˆã‚‰ã‚Œã‚‹ã¨æ€ã„ã¾ã™ã€‚</p>\n<p>çµæ§‹ã‚³ãƒ¼ãƒ‰é‡ãŒå¤šãã¦ã¨ã£ã¤ãã«ãã„æ°—ã‚‚ã—ã¾ã™ã€‚</p>\n<h3>Extension</h3>\n<p>ã†ã¾ã„æ„Ÿã˜ã«å…±é€šåŒ–ã—ãŸã„ã§ã™ãŒé«˜ã•ã‚’æƒãˆã‚‹ã«ã¯UILabelã®fontã¨è¡¨ç¤ºã—ãŸã„ç”»åƒã®ã‚µã‚¤ã‚ºã®æƒ…å ±ãŒå¿…è¦ã«ãªã£ã¦ãã¾ã™ã€‚\nUILabelã®extensionã«ã™ã‚‹ã®ã‚‚ãªã‚“ã‹é•ã†æ°—ãŒã—ã¾ã™ãŒä¸€å¿œ</p>\n<div class=\"gatsby-highlight\" data-language=\".swift\"><pre class=\"language-.swift\"><code class=\"language-.swift\">    label.text = &quot;labelã«çŠ¬ã‚’è¡¨ç¤ºã™ã‚‹&quot;\n    label.insertImage(UIImage(named: &quot;dog.jpg&quot;)!, at: label.text!.count, alignment: .center)</code></pre></div>\n<p>sizeã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§image.sizeã‚’æŒ‡å®šã—ã¾ã™ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\".swift\"><pre class=\"language-.swift\"><code class=\"language-.swift\">    label.insertImage(UIImage(named: &quot;dog.jpg&quot;)!, at: label.text!.count, size: CGSize(width: 30, height: 30), alignment: .center) </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\".swift\"><pre class=\"language-.swift\"><code class=\"language-.swift\">extension UILabel {\n    func insertImage(_ image: UIImage, at index: Int, size: CGSize? = nil, alignment: NSTextAttachment.VerticalAlignment = .center) {\n        let attr = attributedText as? NSMutableAttributedString ?? NSMutableAttributedString(string: text ?? &quot;&quot;)\n        let attachment = NSTextAttachment(image: image, font: font, size: size ?? image.size, alignment: alignment)\n        attr.insert(NSAttributedString(attachment: attachment), at: index)\n        attributedText = attr\n    }\n}\n\nextension NSTextAttachment {\n    convenience init(image: UIImage, font: UIFont, size: CGSize, alignment: VerticalAlignment) {\n        self.init()\n        self.image = image\n        let y: CGFloat\n        switch alignment {\n        case .top:\n            y = font.capHeight - size.height\n        case .bottom:\n            y = font.descender\n        case .center:\n            y = (font.capHeight - size.height).rounded() / 2\n        case .baseline:\n            y = 0\n        }\n        bounds.origin = CGPoint(x: 0, y: y)\n        bounds.size = size\n    }\n    \n    enum VerticalAlignment {\n        case bottom, baseline, center, top\n    }\n}</code></pre></div>\n<p>ãƒ©ãƒ™ãƒ«ã®ä¸Šã«sizeã‚„è¡¨ç¤ºä½ç½®ã®èª¿æ•´ã«ã¤ã„ã¦ã¯<a href=\"https://stackoverflow.com/questions/26105803/center-nstextattachment-image-next-to-single-line-uilabel\">ã“ã¡ã‚‰</a>ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚</p>\n<img src=\"https://i.stack.imgur.com/EtmBW.png\">\n<p>å¼•ç”¨: (<a href=\"https://stackoverflow.com/questions/26105803/center-nstextattachment-image-next-to-single-line-uilabel\">https://stackoverflow.com/questions/26105803/center-nstextattachment-image-next-to-single-line-uilabel</a>)</p>\n<p>ã¡ãªã¿ã«yåº§æ¨™ã¯åè»¢ã—ã¦ã„ã¦ã€UIFont.desendentã¯-ã®å€¤ã‚’è¿”ã—ã¾ã™ã€‚</p>\n<hr>\n<h3>ç”»åƒã¨ã‚‚ã˜ã®ãƒãƒ¼ã‚¸ãƒ³ã‚’èª¿æ•´ã—ãŸã„å ´åˆ</h3>\n<p>ãƒ†ã‚­ã‚¹ãƒˆã¨ç”»åƒã®é–“ã«ã®ãƒãƒ¼ã‚¸ãƒ³ã‚’èª¿æ•´ã—ãŸã„å ´åˆã¯\nã‚¹ãƒšãƒ¼ã‚¹ã‚’å…¥ã‚Œã‚‹ã€fontSizeã‚’èª¿æ•´ã™ã‚‹ã€ã‚‚ã—ãã¯æœ€æ‚ªã®å ´åˆPaddingã‚’ã¤ã‘ãŸç”»åƒã‚’ç”Ÿæˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã‹ãªã¨æ€ã„ã¾ã—ãŸã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\".swift\"><pre class=\"language-.swift\"><code class=\"language-.swift\">    func makeImageWithPadding(image: UIImage, padding: UIEdgeInsets) -&gt; UIImage {\n        UIGraphicsBeginImageContextWithOptions(image.size, false, UIScreen.main.scale)\n        UIGraphicsBeginImageContext(.init(\n                width: image.size.width + padding.left + padding.right,\n                height: image.size.height + padding.top + padding.bottom\n            )\n        )\n        image.draw(at: .init(x: padding.left, y: padding.top))\n        let image = UIGraphicsGetImageFromCurrentImageContext()!\n        UIGraphicsEndImageContext()\n        return image\n    }</code></pre></div>\n<h3>(è¿½è¨˜) Swift5ã§å¼·åŒ–ã•ã‚ŒãŸæ©Ÿèƒ½ã‚’ã¤ã‹ã†ã¨</h3>\n<p><a href=\"https://qiita.com/fmtonakai/items/2e685e3c719d7fda7fc7\">https://qiita.com/fmtonakai/items/2e685e3c719d7fda7fc7</a></p>\n<div class=\"gatsby-highlight\" data-language=\".swift\"><pre class=\"language-.swift\"><code class=\"language-.swift\">let attrStr: AttributedString = &quot;ä»Šæ—¥ã¯ã„ã„å¤©æ°—ã \\(image)&quot;</code></pre></div>\n<p>ã“ã†ã‚†ã†å®Ÿè£…ã‚‚ã§ãã‚‹ã‚ˆã†</p>","frontmatter":{"title":"Swift5 UILabelã«ç”»åƒ(UIImage)ã‚’è¡¨ç¤ºã™ã‚‹ NSAttributedString NSTextAttachment","tags":["Xcode","iOS","Swift"],"date":"2019å¹´05æœˆ10æ—¥"}}},"pageContext":{"id":"defafadb-9d0e-5eed-aaff-b8c93f7d2c89"}}}