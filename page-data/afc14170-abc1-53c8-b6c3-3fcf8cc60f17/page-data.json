{"componentChunkName":"component---src-templates-post-js","path":"/afc14170-abc1-53c8-b6c3-3fcf8cc60f17","result":{"data":{"markdownRemark":{"html":"<p>vueとかanglureとか触ってるとSwiftでボタン定義するのすごくだるいなと思う。(mac book airなのでIBは触りたくない）</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">ng-click</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>ctrl.onClick<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>anglure<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\"><span class=\"token namespace\">v-on:</span>click</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>say('what')<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span> vue <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span> </code></pre></div>\n<p>だからButtonクラスを作ってちょっとだけ楽してみた。</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ViewController</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewController</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> button <span class=\"token operator\">=</span> <span class=\"token function\">Button</span><span class=\"token punctuation\">(</span>\n        title<span class=\"token punctuation\">:</span> <span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span>\n        backgroundColor<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>blue<span class=\"token punctuation\">,</span>\n        parent<span class=\"token punctuation\">:</span> view<span class=\"token punctuation\">,</span>\n        onClick<span class=\"token punctuation\">:</span> onClickButton\n    <span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> onClickButton <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tap\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<p>ちなみにself参照するときはweakつけないとなーくらいに思ってたんでずけど、</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\">  <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> onClickButton <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">weak</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">in</span>\n       <span class=\"token keyword\">self</span><span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token function\">hogehoge</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>関数を渡してあげると、buttonが解放されなかった。なんででしょうか・・</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ViewController</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewController</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> button <span class=\"token operator\">=</span> <span class=\"token function\">Button</span><span class=\"token punctuation\">(</span>\n        title<span class=\"token punctuation\">:</span> <span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span>\n        backgroundColor<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>blue<span class=\"token punctuation\">,</span>\n        parent<span class=\"token punctuation\">:</span> view<span class=\"token punctuation\">,</span>\n        onClick<span class=\"token punctuation\">:</span> tapButton\n    <span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">tapButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tap\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<details><summary>ソースはこれです</summary><div>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Button</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIButton</span> <span class=\"token punctuation\">{</span>\n  \n    <span class=\"token keyword\">convenience</span> <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>\n        title<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n        color<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIColor</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>darkGray<span class=\"token punctuation\">,</span>\n        backgroundColor<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIColor</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>clear<span class=\"token punctuation\">,</span>\n        parent<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIView</span><span class=\"token operator\">?</span> <span class=\"token operator\">=</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">,</span>\n        onClick<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">Swift</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">Void</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token operator\">=</span> <span class=\"token constant\">nil</span>\n        <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>zero<span class=\"token punctuation\">)</span>\n        \n        <span class=\"token function\">addTarget</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">self</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">:</span> #<span class=\"token function\">selector</span><span class=\"token punctuation\">(</span>actionClick<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>touchUpInside<span class=\"token punctuation\">)</span>\n        <span class=\"token function\">setTitle</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span>\n        <span class=\"token function\">setTitleColor</span><span class=\"token punctuation\">(</span>color<span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>backgroundColor <span class=\"token operator\">=</span> backgroundColor\n        clickHandler <span class=\"token operator\">=</span> onClick\n        parent<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token function\">addSubview</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">self</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> clickHandler<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">Swift</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">Void</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span>\n    \n    <span class=\"token atrule\">@objc</span> <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">actionClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        clickHandler<span class=\"token operator\">?</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</div></details>\n<p>Swiftでもこうやってかけるようにしてみようかな・・</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\">    <span class=\"token keyword\">private</span> <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> label <span class=\"token operator\">=</span> <span class=\"token function\">Label</span><span class=\"token punctuation\">(</span>\n        textColor<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>darkGray<span class=\"token punctuation\">,</span>\n        parent<span class=\"token punctuation\">:</span> view<span class=\"token punctuation\">,</span>\n        bind<span class=\"token punctuation\">:</span> store<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>text\n    <span class=\"token punctuation\">)</span></code></pre></div>\n<h2>昔ちょこっと試してた初期化方法(おまけ)</h2>\n<h3>lazyで初期化</h3>\n<p>基本的にはこれで初期化している。Extensionを使ってないから普通にSnipetにしてどこでも使える。</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ViewController</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewController</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> button<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIButton</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> b <span class=\"token operator\">=</span> <span class=\"token function\">UIButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        b<span class=\"token punctuation\">.</span><span class=\"token function\">setTitle</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span>\n        b<span class=\"token punctuation\">.</span><span class=\"token function\">addTarget</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">self</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">:</span> #<span class=\"token function\">selector</span><span class=\"token punctuation\">(</span>actionTap<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>touchUpInside<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n        <span class=\"token keyword\">return</span> b\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token atrule\">@objc</span> <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">actionTap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button touch up inside\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>メソッドチェーンで初期化</h3>\n<p>メソッドチェーンでかけるExtensionを作ってKotlinのスコープ関数のように初期化してみたり</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ViewController</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewController</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> button <span class=\"token operator\">=</span> <span class=\"token function\">UIButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>apply <span class=\"token punctuation\">{</span> $<span class=\"token number\">0</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">setTitle</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">addTarget</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">self</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">:</span> #<span class=\"token function\">selector</span><span class=\"token punctuation\">(</span>actionTap<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>touchUpInside<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token atrule\">@objc</span> <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">actionTap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button touch up inside\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>　AddTargetのみ省略</h3>\n<p>RxSwiftの<code class=\"language-text\">button.rx.tap</code>が便利だったので\nNotificationCenterやocjcの黒魔術を使ってaddTargetのみ省略したり</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ViewController</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewController</span> <span class=\"token punctuation\">{</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> button <span class=\"token operator\">=</span> <span class=\"token function\">UIButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">setUpButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        button<span class=\"token punctuation\">.</span><span class=\"token function\">setTitle</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span>\n        button<span class=\"token punctuation\">.</span>onTap <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n           <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button touch up inside\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"UIButtonをdeclarativeに扱う","tags":["Objective-C","Xcode","iOS","Vue.js","Swift"],"date":"2019年03月31日"}},"sameTagPosts":{"edges":[{"node":{"id":"01361ba1-5b01-5e53-b04b-9bc1fdb2805f","frontmatter":{"title":"JavaScriptのthisは難しくない","tags":["JavaScript","TypeScript","Vue.js","React"],"date":"2020年04月12日"}}},{"node":{"id":"fa032aee-2b4e-50bf-ad2b-200d44d39000","frontmatter":{"title":"create-react-appを使わずにReactの環境構築をして周辺ツールとかを理解する","tags":["JavaScript","TypeScript","Vue.js","React"],"date":"2019年12月09日"}}},{"node":{"id":"8845f661-5548-599d-8a4e-6a5320066ede","frontmatter":{"title":"SwiftUIでTextViewを使う","tags":["iOS","Swift","SwiftUI"],"date":"2019年10月27日"}}},{"node":{"id":"c57e83f6-2e10-5f63-abfb-b78c3814e7c3","frontmatter":{"title":"SwiftUIとXcodeのPreviewでオートレイアウトをリアルタイムで確認しながら実装できて感動した","tags":["Xcode","iOS","AutoLayout","Swift","SwiftUI"],"date":"2019年10月16日"}}},{"node":{"id":"36c8d4f0-7394-5bff-b6b5-bae80a8113aa","frontmatter":{"title":"Swift5.1 dynamicMemberLookup^KeyPathを使ってSwiftにKotolinのapplyを実装する","tags":["Xcode","iOS","Kotlin","Swift"],"date":"2019年10月04日"}}}]}},"pageContext":{"id":"afc14170-abc1-53c8-b6c3-3fcf8cc60f17","tags":["Objective-C","Xcode","iOS","Vue.js","Swift"]}}}