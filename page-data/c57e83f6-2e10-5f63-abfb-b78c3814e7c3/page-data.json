{"componentChunkName":"component---src-templates-post-js","path":"/c57e83f6-2e10-5f63-abfb-b78c3814e7c3","result":{"data":{"markdownRemark":{"html":"<p>先週くらいにXcode11に上げてようやく触り始めたのですが、感動してしまったので動画に撮りました。</p>\n<p><img src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/166241/95f50b09-6e2c-2346-9cd3-db6930ea93be.gif\" alt=\"preview.gif\"></p>\n<p>なんかUIViewRepresentableを使えば、SwiftUIでUIKitのViewを使えますよね</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">struct</span> <span class=\"token builtin\">AutoLayout</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewRepresentable</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">updateUIView</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> view<span class=\"token punctuation\">:</span> <span class=\"token builtin\">AutoLayoutView</span><span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewRepresentableContext</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">AutoLayout</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">func</span> <span class=\"token function\">makeUIView</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewRepresentableContext</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">AutoLayout</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">AutoLayoutView</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">AutoLayoutView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>もちろんPreviewにも表示されるわけです。</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">struct</span> <span class=\"token builtin\">AutoLayout_Previews</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">PreviewProvider</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">var</span> previews<span class=\"token punctuation\">:</span> some <span class=\"token builtin\">View</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">AutoLayout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">previewLayout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token function\">fixed</span><span class=\"token punctuation\">(</span>width<span class=\"token punctuation\">:</span> <span class=\"token number\">414</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Twitterを見ているとベータ版を触られてる人たちがコードレイアウトで書いても良さそうとか言ってたので、\nオートレイアウトを試してみようといじってました。\nでAutoLayoutViewの内部でコードでオートレイアウトを指定してあげたんですが、なんかpreviewに即反映されたんですよ。</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AutoLayoutView</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIView</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">required</span> <span class=\"token keyword\">init</span><span class=\"token operator\">?</span><span class=\"token punctuation\">(</span>coder<span class=\"token punctuation\">:</span> <span class=\"token builtin\">NSCoder</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">fatalError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"init(coder:) has not been implemented\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> label <span class=\"token operator\">=</span> <span class=\"token function\">UILabel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGRect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">:</span> frame<span class=\"token punctuation\">)</span>\n        <span class=\"token function\">initializeConstraints</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">initializeConstraints</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// label.leftAnchor....</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>もしやと思いオートレイアウトをコードで書く用の自作Extensionを追加していじってみると、これも反映されました。\nそれが冒頭のgifです。</p>\n<hr>\n<p>勤務先の企業でSwiftUIをメインのアプリで使えるようになるには後２年程かかるのでまだまだオートレイアウトを使わなければいけないのですが、このPreview機能の恩恵は大きそうです。</p>\n<hr>\n<p>ソースはこんな感じです。\nメソッドチェーンの ExtensionはNSLayoutAnchorをラップしているだけです。</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AutoLayoutView</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIView</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">required</span> <span class=\"token keyword\">init</span><span class=\"token operator\">?</span><span class=\"token punctuation\">(</span>coder<span class=\"token punctuation\">:</span> <span class=\"token builtin\">NSCoder</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">fatalError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"init(coder:) has not been implemented\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">:</span> <span class=\"token builtin\">CGRect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">:</span> frame<span class=\"token punctuation\">)</span>\n        <span class=\"token function\">initializeView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">initializeConstraints</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> iconImageView <span class=\"token operator\">=</span> <span class=\"token function\">UIImageView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> nameLabel <span class=\"token operator\">=</span> <span class=\"token function\">UILabel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">initializeView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        nameLabel<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> <span class=\"token string\">\"abouch\"</span>\n        nameLabel<span class=\"token punctuation\">.</span>backgroundColor <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>green\n        <span class=\"token function\">addSubview</span><span class=\"token punctuation\">(</span>nameLabel<span class=\"token punctuation\">)</span>\n\n        iconImageView<span class=\"token punctuation\">.</span>backgroundColor <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>red\n        iconImageView<span class=\"token punctuation\">.</span>layer<span class=\"token punctuation\">.</span>cornerRadius <span class=\"token operator\">=</span> <span class=\"token number\">20</span>\n        <span class=\"token function\">addSubview</span><span class=\"token punctuation\">(</span>iconImageView<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">func</span> <span class=\"token function\">initializeConstraints</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        iconImageView<span class=\"token punctuation\">.</span>chura<span class=\"token punctuation\">.</span>layout\n            <span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token keyword\">left</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">centerY</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">self</span><span class=\"token punctuation\">)</span>\n        \n        nameLabel<span class=\"token punctuation\">.</span>chura<span class=\"token punctuation\">.</span>layout\n            <span class=\"token punctuation\">.</span><span class=\"token keyword\">left</span><span class=\"token punctuation\">(</span>iconImageView<span class=\"token punctuation\">.</span>rightAnchor <span class=\"token operator\">+</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">top</span><span class=\"token punctuation\">(</span>iconImageView<span class=\"token punctuation\">.</span>topAnchor <span class=\"token operator\">+</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token keyword\">right</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">height</span><span class=\"token punctuation\">(</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"SwiftUIとXcodeのPreviewでオートレイアウトをリアルタイムで確認しながら実装できて感動した","tags":["Xcode","iOS","AutoLayout","Swift","SwiftUI"],"date":"2019年10月16日"}},"sameTagPosts":{"edges":[{"node":{"id":"8845f661-5548-599d-8a4e-6a5320066ede","frontmatter":{"title":"SwiftUIでTextViewを使う","tags":["iOS","Swift","SwiftUI"],"date":"2019年10月27日"}}},{"node":{"id":"36c8d4f0-7394-5bff-b6b5-bae80a8113aa","frontmatter":{"title":"Swift5.1 dynamicMemberLookup^KeyPathを使ってSwiftにKotolinのapplyを実装する","tags":["Xcode","iOS","Kotlin","Swift"],"date":"2019年10月04日"}}},{"node":{"id":"6aa8f8fc-5836-52a8-bd46-ae56d1d4f4de","frontmatter":{"title":"SwiftでTooltipを描画する","tags":["iOS","UIKit","Swift"],"date":"2019年08月31日"}}},{"node":{"id":"fa82a31d-4690-5cb8-a507-42237d6afec2","frontmatter":{"title":"実機１台で別端末のレイアウトを確認する方法","tags":["Xcode","iOS","Swift"],"date":"2019年08月15日"}}},{"node":{"id":"4ac87f61-abdb-5629-97f6-79d92e985fce","frontmatter":{"title":"Swiftで簡単なGrid Layoutを実装するためのレイアウトクラス （UIKit）","tags":["iOS","Swift"],"date":"2019年07月06日"}}}]}},"pageContext":{"id":"c57e83f6-2e10-5f63-abfb-b78c3814e7c3","tags":["Xcode","iOS","AutoLayout","Swift","SwiftUI"]}}}