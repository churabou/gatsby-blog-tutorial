<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/gatsby-blog-tutorial/styles.23aec93274c2f3dd0556.css">body{margin:0;--theme-color:#2f5b83}.gatsby-remark-code-name{margin:0 0 -.5em .5em}.gatsby-remark-code-name span{background:grey;color:#fff;padding:.25em}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.20.36"/><style data-styled="" data-styled-version="5.1.0">.ecpyWB{background:#999;padding:1em;color:white;}/*!sc*/
data-styled.g1[id="Footer__Wrapper-qhytvz-0"]{content:"ecpyWB,"}/*!sc*/
.dmeTcP{background:var(--theme-color);margin:0px;padding:0.5em 1em;color:white;}/*!sc*/
.dmeTcP a{-webkit-text-decoration:none;text-decoration:none;color:white;}/*!sc*/
data-styled.g2[id="Header__Wrapper-sc-1isb4n6-0"]{content:"dmeTcP,"}/*!sc*/
.hNBxKb{min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}/*!sc*/
.hNBxKb > div{-webkit-flex:auto;-ms-flex:auto;flex:auto;}/*!sc*/
data-styled.g3[id="Layout__Wrapper-sc-1l83v77-0"]{content:"hNBxKb,"}/*!sc*/
.cJcvIG{background:#f4f4f4;padding:2em;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-around;-webkit-justify-content:space-around;-ms-flex-pack:space-around;justify-content:space-around;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;word-wrap:break-word;}/*!sc*/
.cJcvIG > article{width:60%;background:white;border-radius:2px;padding:1.5em;margin-bottom:1.5em;}/*!sc*/
@media screen and (max-width:768px){.cJcvIG > article{width:100%;}}/*!sc*/
.cJcvIG > article div:last-child img{max-width:100%;}/*!sc*/
.cJcvIG > article div:last-child a{color:var(--theme-color);-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.cJcvIG .frontmatter.tag{display:inline-block;background:var(--theme-color);color:white;margin:0 0.25em 0.25em 0;padding:0.25em;}/*!sc*/
.cJcvIG .frontmatter.date{margin-top:0.5em;color:#666;}/*!sc*/
.cJcvIG > section{width:30%;}/*!sc*/
@media screen and (max-width:768px){.cJcvIG > section{width:100%;}}/*!sc*/
.cJcvIG > section h3{padding:0.5em;margin:0px;border-radius:2px;box-sizing:content-box;color:white;background:var(--theme-color);}/*!sc*/
.cJcvIG > section ul{list-style:none;padding:0px;}/*!sc*/
.cJcvIG > section ul li{padding:0.75em;background:white;margin-bottom:1em;border-radius:2px;}/*!sc*/
.cJcvIG > section ul a{-webkit-text-decoration:none;text-decoration:none;color:black;}/*!sc*/
data-styled.g6[id="post__Body-hsjs07-0"]{content:"cJcvIG,"}/*!sc*/
</style><link as="script" rel="preload" href="/gatsby-blog-tutorial/webpack-runtime-8bebf53f2ab1137c833a.js"/><link as="script" rel="preload" href="/gatsby-blog-tutorial/framework-995310802c8b4a765741.js"/><link as="script" rel="preload" href="/gatsby-blog-tutorial/styles-c3197c6105318d4816ab.js"/><link as="script" rel="preload" href="/gatsby-blog-tutorial/app-8b3b949d4808e61478e4.js"/><link as="script" rel="preload" href="/gatsby-blog-tutorial/fa2fe427c434b74684fd0fa46a4e612bba9c9738-5bc62388e00a73cdabe3.js"/><link as="script" rel="preload" href="/gatsby-blog-tutorial/component---src-templates-post-js-d525f185aca2fa6f2115.js"/><link as="fetch" rel="preload" href="/gatsby-blog-tutorial/page-data/d18347c9-78a4-5096-8b1b-afeefdbeceba/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/gatsby-blog-tutorial/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout__Wrapper-sc-1l83v77-0 hNBxKb"><header class="Header__Wrapper-sc-1isb4n6-0 dmeTcP"><h1><a href="/gatsby-blog-tutorial/">Qiitaに書いたやつ</a></h1></header><div><div class="post__Body-hsjs07-0 cJcvIG"><article><h1>Boostnoteをcloneして自分好みのMarkdownメモアプリを作成する</h1><div><span class="frontmatter tag">JavaScript</span><span class="frontmatter tag">Node.js</span><span class="frontmatter tag">Markdown</span><span class="frontmatter tag">React</span><span class="frontmatter tag">Electron</span></div><div class="frontmatter date"><b>2019年07月15日</b></div><div><p>仕事をする上でメモを取ることはめちゃくちゃ大切だと思います。エンジニアは特にそうだと思います。
私もよくメモを取るのですが、自分好みのメモ帳が存在しないので自作することにしました。</p>
<p>electron + vue.js でプロトタイプを作っていたのですが、調べていたとこ、boostnoteがOSSとして公開されていることを知りました。2年ほど前使っていてかなり良かったのですが、ちょっと気に入らない点があってやめてしました。</p>
<p>今回はOSSとして公開されているBoostnoteを引っ張ってきて、カスタマイズしていこうと思います。</p>
<p><a href="https://github.com/BoostIO/Boostnote">GitHub - BoostIO/Boostnote: A markdown editor for developers on Mac, Windows and Linux.</a></p>
<h3>成果物</h3>
<img width="1680" alt="スクリーンショット 2019-07-15 19.50.07.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/166241/197668e4-b868-b645-6fe6-6c3cbbb773e1.png">
<p>写真だと上にタイトル入力画面追加したくらいしかわからないですね</p>
<h3>とりあえず起動する</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">git clone git@github.com:BoostIO/Boostnote.git</code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">cd boostnote</code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">yarn 
yarn run dev</code></pre></div>
<p><a href="https://github.com/BoostIO/Boostnote/blob/master/docs/build.md">Boostnote/build.md at master · BoostIO/Boostnote · GitHub</a></p>
<p>環境によっては最初のyarnが少し時間かかるかもしれません。
これだけでBoostnoteが起動します。</p>
<img width="1680" alt="スクリーンショット 2019-07-15 19.48.14.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/166241/caa9a346-f794-8704-45fb-7583f8952b41.png">
<p>個人的にはGUIの操作がないぶん普通にインストールする楽なきがします</p>
<h3>事前準備</h3>
<p>特にないです。適当にドキュメント眺める程度です。</p>
<ul>
<li><a href="https://electronjs.org/">Electron | Build cross platform desktop apps with JavaScript, HTML, and CSS.</a></li>
<li><a href="https://ja.reactjs.org/">React – ユーザインターフェース構築のための JavaScript ライブラリ</a></li>
<li><a href="http://stylus-lang.com">Expressive, dynamic, robust CSS — expressive, robust, feature-rich CSS preprocessor</a></li>
<li><a href="https://electronjs.org/docs/tutorial/devtools-extension">DevTools Extension | Electron</a></li>
</ul>
<p>Reactのdevtoolがchromeに未インストールの場合は一応しときます。
electronでdev tool 使うにはなにか必要ぽっかったのですが普通に使えました。</p>
<h3>いじってみる</h3>
<p>以下、個人的に気に入らない部分をいじっていきます。
なんか変更したら更新していくと思います。</p>
<h5>新規作成時にMarkdonw Note or Snippet Noteのモーダルが出てくる</h5>
<p>Boostnoteのsnippet機能は使わないので、新規作成ですぐにマークダウンを生成してほしいので写真のモーダルはいらない。</p>
<img width="1680" alt="スクリーンショット 2019-07-15 19.47.41.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/166241/e815ad6a-fd65-8c41-5376-a69575f4bfba.png">
<p>この程度なら設定で変えられそうと思いながらソースを追っていったら</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">  <span class="token function">handleNewNoteButtonClick</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> location<span class="token punctuation">,</span> dispatch<span class="token punctuation">,</span> match<span class="token operator">:</span> <span class="token punctuation">{</span> params <span class="token punctuation">}</span><span class="token punctuation">,</span> config <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
    <span class="token keyword">const</span> <span class="token punctuation">{</span> storage<span class="token punctuation">,</span> folder <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resolveTargetFolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>defaultNote <span class="token operator">===</span> <span class="token string">'MARKDOWN_NOTE'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">createMarkdownNote</span><span class="token punctuation">(</span>storage<span class="token punctuation">.</span>key<span class="token punctuation">,</span> folder<span class="token punctuation">.</span>key<span class="token punctuation">,</span> dispatch<span class="token punctuation">,</span> location<span class="token punctuation">,</span> params<span class="token punctuation">,</span> config<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>defaultNote <span class="token operator">===</span> <span class="token string">'SNIPPET_NOTE'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">createSnippetNote</span><span class="token punctuation">(</span>storage<span class="token punctuation">.</span>key<span class="token punctuation">,</span> folder<span class="token punctuation">.</span>key<span class="token punctuation">,</span> dispatch<span class="token punctuation">,</span> location<span class="token punctuation">,</span> params<span class="token punctuation">,</span> config<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      modal<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>NewNoteModal<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        storage<span class="token operator">:</span> storage<span class="token punctuation">.</span>key<span class="token punctuation">,</span>
        folder<span class="token operator">:</span> folder<span class="token punctuation">.</span>key<span class="token punctuation">,</span>
        dispatch<span class="token punctuation">,</span>
        location<span class="token punctuation">,</span>
        params<span class="token punctuation">,</span>
        config
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span></code></pre></div>
<p>configで条件分岐していました。設定でオフにできそうです。
と思ったけど、100%使用しないのでごっそり削ります。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">  <span class="token function">handleNewNoteButtonClick</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> location<span class="token punctuation">,</span> dispatch<span class="token punctuation">,</span> match<span class="token operator">:</span> <span class="token punctuation">{</span> params <span class="token punctuation">}</span><span class="token punctuation">,</span> config <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
    <span class="token keyword">const</span> <span class="token punctuation">{</span> storage<span class="token punctuation">,</span> folder <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resolveTargetFolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">createMarkdownNote</span><span class="token punctuation">(</span>storage<span class="token punctuation">.</span>key<span class="token punctuation">,</span> folder<span class="token punctuation">.</span>key<span class="token punctuation">,</span> dispatch<span class="token punctuation">,</span> location<span class="token punctuation">,</span> params<span class="token punctuation">,</span> config<span class="token punctuation">)</span>
  <span class="token punctuation">}</span></code></pre></div>
<p><a href="https://github.com/BoostIO/Boostnote/blob/master/browser/main/NewNoteButton/index.js#L35#L52">https://github.com/BoostIO/Boostnote/blob/master/browser/main/NewNoteButton/index.js#L35#L52</a></p>
<h5>タグのスタイルが気に食わない</h5>
<p>Before</p>
<img width="236" alt="スクリーンショット 2019-07-16 9.09.31.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/166241/294b0a30-57cc-c0ad-e2eb-83e9e653c892.png">
<p>After</p>
<img width="220" alt="スクリーンショット 2019-07-16 9.09.24.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/166241/cdb31721-f5e6-ef30-24b6-2bf35d326d73.png">
<p>個人的にはタグの頭の#が不要で、あと色も薄いので変えたい。
頭の#に関しては表示場所で追加してるだけなので、適当に目星をつけてgrepして直ぐに発見。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">xxxx ~/w/Boostnote&gt; git grep &quot;#{tag&quot;
browser/components/NoteItem.js:      #{tagName}
browser/main/Detail/TagSelect.js:            &lt;span styleName=&#39;tag-label&#39; style={textStyle} onClick={(e) =&gt; this.handleTagLabelClick(tag)}&gt;#{tag}&lt;/span&gt;</code></pre></div>
<p>出てきた箇所の#を消します。</p>
<p>ついでに色を変更したいと思いみてみると、config.coloredTagsという部分を発見。
どうやら設定でかえられる？と思いつつ見てみると、タグ毎に色をつけられるらしい。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">        <span class="token operator">&lt;</span>TagSelect
          ref<span class="token operator">=</span><span class="token string">'tags'</span>
          value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>note<span class="token punctuation">.</span>tags<span class="token punctuation">}</span>
          saveTagsAlphabetically<span class="token operator">=</span><span class="token punctuation">{</span>config<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>saveTagsAlphabetically<span class="token punctuation">}</span>
          showTagsAlphabetically<span class="token operator">=</span><span class="token punctuation">{</span>config<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>showTagsAlphabetically<span class="token punctuation">}</span>
          data<span class="token operator">=</span><span class="token punctuation">{</span>data<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleUpdateTag</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
          coloredTags<span class="token operator">=</span><span class="token punctuation">{</span>config<span class="token punctuation">.</span>coloredTags<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span></code></pre></div>
<p>なるほど・・</p>
<p>タグの生成時に自動で自分の好きな色を追加してしまおうと思ったが
そもそもタグに色つけないので、デフォルトのテーマカラーを変えました。</p>
<p><a href="https://github.com/churabou/Boostnote/commit/0d8c3529ed13db6b20b61a36d4eb81a6c2584f85">https://github.com/churabou/Boostnote/commit/0d8c3529ed13db6b20b61a36d4eb81a6c2584f85</a></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">  <span class="token function">handleColorPickerConfirm</span> <span class="token punctuation">(</span><span class="token parameter">color</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> dispatch<span class="token punctuation">,</span> config<span class="token operator">:</span> <span class="token punctuation">{</span>coloredTags<span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
    <span class="token keyword">const</span> <span class="token punctuation">{</span> colorPicker<span class="token operator">:</span> <span class="token punctuation">{</span> tagName <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">const</span> newColoredTags <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> coloredTags<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>tagName<span class="token punctuation">]</span><span class="token operator">:</span> color<span class="token punctuation">.</span>hex<span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span> coloredTags<span class="token operator">:</span> newColoredTags <span class="token punctuation">}</span>
    ConfigManager<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token string">'SET_CONFIG'</span><span class="token punctuation">,</span>
      config
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dismissColorPicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span></code></pre></div>
<h5>1行目がタイトルになるけど、タイトルは別に入力したい。</h5>
<p>Qiitaとかはてブとかのの記事作成画面のように、タイトルはタイトル入力用のボックスに入力したい。</p>
<img width="1680" alt="スクリーンショット 2019-07-15 19.50.07.png" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/166241/197668e4-b868-b645-6fe6-6c3cbbb773e1.png">
<p><a href="https://github.com/churabou/Boostnote/commit/4a1b835f3cd687efd73769b3b3949ac5de9685f2">https://github.com/churabou/Boostnote/commit/4a1b835f3cd687efd73769b3b3949ac5de9685f2</a></p>
<h5>入力画面をスクロールするとプレビューも追随してスクロールするのがうざい。</h5>
<p>入力画面をスクロールすると追随してPreview画面もスクロールしてくれるのですが、移動にアニメーションあってすごい鬱陶しいです。
これは親切な機能なのですがすごくもどかしい。アニメーションを無効にしたいと思います。その点Qiitaの記事作成画面は自然に追随してくれて良いですね！</p>
<p><a href="https://github.com/BoostIO/Boostnote/blob/master/browser/components/MarkdownSplitEditor.js#L32L75">https://github.com/BoostIO/Boostnote/blob/master/browser/components/MarkdownSplitEditor.js#L32L75</a></p>
<p>このあたり、なんかめっちゃスクロールしてそうです。<code class="language-text">this.props.config.preview.scrollSync</code>とあってこれも設定で変えられそうに思いきや、追随を無効にしてくれるだけですね。アニメーションを無効にしたいのでやっぱりソースイジる必要がありました。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">  <span class="token function">handleScroll</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>config<span class="token punctuation">.</span>preview<span class="token punctuation">.</span>scrollSync<span class="token punctuation">)</span> <span class="token keyword">return</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'123445'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> previewDoc <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'refs.preview.refs.root.contentWindow.document'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> codeDoc <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'refs.code.editor.doc'</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> srcTop<span class="token punctuation">,</span> srcHeight<span class="token punctuation">,</span> targetTop<span class="token punctuation">,</span> targetHeight

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userScroll<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>doc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        srcTop <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">'doc.scrollTop'</span><span class="token punctuation">)</span>
        srcHeight <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">'doc.height'</span><span class="token punctuation">)</span>
        targetTop <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>previewDoc<span class="token punctuation">,</span> <span class="token string">'body.scrollTop'</span><span class="token punctuation">)</span>
        targetHeight <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>previewDoc<span class="token punctuation">,</span> <span class="token string">'body.scrollHeight'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        srcTop <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>previewDoc<span class="token punctuation">,</span> <span class="token string">'body.scrollTop'</span><span class="token punctuation">)</span>
        srcHeight <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>previewDoc<span class="token punctuation">,</span> <span class="token string">'body.scrollHeight'</span><span class="token punctuation">)</span>
        targetTop <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>codeDoc<span class="token punctuation">,</span> <span class="token string">'scrollTop'</span><span class="token punctuation">)</span>
        targetHeight <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>codeDoc<span class="token punctuation">,</span> <span class="token string">'height'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">const</span> distance <span class="token operator">=</span> <span class="token punctuation">(</span>targetHeight <span class="token operator">*</span> srcTop <span class="token operator">/</span> srcHeight<span class="token punctuation">)</span> <span class="token operator">-</span> targetTop
      <span class="token keyword">const</span> framerate <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span>
      <span class="token keyword">const</span> frames <span class="token operator">=</span> <span class="token number">20</span>
      <span class="token keyword">const</span> refractory <span class="token operator">=</span> frames <span class="token operator">*</span> framerate

      <span class="token keyword">this</span><span class="token punctuation">.</span>userScroll <span class="token operator">=</span> <span class="token boolean">false</span>

      <span class="token keyword">let</span> frame <span class="token operator">=</span> <span class="token number">0</span>
      <span class="token keyword">let</span> scrollPos<span class="token punctuation">,</span> time
      <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        time <span class="token operator">=</span> frame <span class="token operator">/</span> frames
        scrollPos <span class="token operator">=</span> time <span class="token operator">&lt;</span> <span class="token number">0.5</span>
                  <span class="token operator">?</span> <span class="token number">2</span> <span class="token operator">*</span> time <span class="token operator">*</span> time <span class="token comment">// ease in</span>
                  <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> time<span class="token punctuation">)</span> <span class="token operator">*</span> time <span class="token comment">// ease out</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>doc<span class="token punctuation">)</span> _<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>previewDoc<span class="token punctuation">,</span> <span class="token string">'body.scrollTop'</span><span class="token punctuation">,</span> targetTop <span class="token operator">+</span> scrollPos <span class="token operator">*</span> distance<span class="token punctuation">)</span>
        <span class="token keyword">else</span> _<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'refs.code.editor'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> targetTop <span class="token operator">+</span> scrollPos <span class="token operator">*</span> distance<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>frame <span class="token operator">>=</span> frames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
          <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userScroll <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> refractory<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        frame<span class="token operator">++</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> framerate<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span></code></pre></div>
<p>下の方を少しだけ変更してアニメーションを無効にします。</p>
<h5>ショートカットを追加する</h5>
<ul>
<li>時間がある時に更新</li>
</ul>
<h3>Buildする (Help me)</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">grunt pre-build</code></pre></div>
<p>をすると/distにboostnoteが生成される。
ただこれを起動するとロード画面のまま起動せず、devtoolを見てみると、
<code class="language-text">Uncaught TypeError: Cannot read property &#39;apply&#39; of undefineｄ</code>と出てくる。
これで検索するとgrup4とかでてくるけど、つかってなさそうだし。
そもそもローカルでもbuildできないように制限されてるのかな？そんなことはないと思うけど。</p>
<p>どなたかわかる方、コメントよろしくおねがいします。</p>
<h3>感想</h3>
<ul>
<li>git clone してすぐに起動できるが素晴らしすぎる。</li>
<li>ソースコードの質の高さは判断できないがが、シンプルに実装されていて読みやすい</li>
<li>今回いじった部分ではファイルの行数がそこまで多くなかった。</li>
<li>かなり素直に実装されていて、React触ったことなくてもなんとなく処理を追うことができた。</li>
<li>Javascriptの文法も若干見たことがなかったものがあったり、ちょっぴり楽しかった。</li>
<li>アプリとか作るの好きな人はソース追ってて楽しいと思う。</li>
</ul>
<h4>React勉強したい人は絶対cloneしてソース追ってみるべき</h4>
<p>これだけのアプリのソースが無料で公開されているのでそう思いました。</p></div></article><section><h3>同じタグの投稿</h3><ul><li><a href="/gatsby-blog-tutorial/c26ea8f6-1198-5a65-8885-a33809cefcdc"><h4>Gatsbyで1時間でブログを作るチュートリアル (Qiitaの記事を移行する)</h4><div><span class="frontmatter tag">JavaScript</span><span class="frontmatter tag">React</span><span class="frontmatter tag">gatsby</span></div><div class="frontmatter date"><b>2020年04月27日</b></div></a></li><li><a href="/gatsby-blog-tutorial/34226e4f-0a84-533b-b543-be011c238051"><h4>RxJSのswitchMap mergeMap concatMap</h4><div><span class="frontmatter tag">JavaScript</span><span class="frontmatter tag">RxJS</span><span class="frontmatter tag">Rx</span></div><div class="frontmatter date"><b>2020年04月12日</b></div></a></li><li><a href="/gatsby-blog-tutorial/01361ba1-5b01-5e53-b04b-9bc1fdb2805f"><h4>JavaScriptのthisは難しくない</h4><div><span class="frontmatter tag">JavaScript</span><span class="frontmatter tag">TypeScript</span><span class="frontmatter tag">Vue.js</span><span class="frontmatter tag">React</span></div><div class="frontmatter date"><b>2020年04月12日</b></div></a></li><li><a href="/gatsby-blog-tutorial/5fa0c2c8-65d8-51a2-a79c-447589ed9dba"><h4>JavaScriptでカジュアルに日付操作する</h4><div><span class="frontmatter tag">JavaScript</span><span class="frontmatter tag">TypeScript</span></div><div class="frontmatter date"><b>2020年03月21日</b></div></a></li><li><a href="/gatsby-blog-tutorial/0bf1e7c5-5ba4-5835-b370-47df6c8e0933"><h4>Gatsbyを最速で理解するためのチュートリアル</h4><div><span class="frontmatter tag">JavaScript</span><span class="frontmatter tag">静的サイトジェネレーター</span><span class="frontmatter tag">React</span><span class="frontmatter tag">gatsby</span></div><div class="frontmatter date"><b>2019年12月14日</b></div></a></li></ul></section></div></div><footer class="Footer__Wrapper-qhytvz-0 ecpyWB">2020 churabou</footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/d18347c9-78a4-5096-8b1b-afeefdbeceba";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-8b3b949d4808e61478e4.js"],"component---src-templates-list-js":["/component---src-templates-list-js-52ab88b29333f1950ffe.js"],"component---src-templates-post-js":["/component---src-templates-post-js-d525f185aca2fa6f2115.js"]};/*]]>*/</script><script src="/gatsby-blog-tutorial/component---src-templates-post-js-d525f185aca2fa6f2115.js" async=""></script><script src="/gatsby-blog-tutorial/fa2fe427c434b74684fd0fa46a4e612bba9c9738-5bc62388e00a73cdabe3.js" async=""></script><script src="/gatsby-blog-tutorial/app-8b3b949d4808e61478e4.js" async=""></script><script src="/gatsby-blog-tutorial/styles-c3197c6105318d4816ab.js" async=""></script><script src="/gatsby-blog-tutorial/framework-995310802c8b4a765741.js" async=""></script><script src="/gatsby-blog-tutorial/webpack-runtime-8bebf53f2ab1137c833a.js" async=""></script></body></html>